<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pixelwatch-Sensor</title>
    <link rel="icon" type="image/x-icon" href="./ressources/favicon.ico">

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/9.19.1/firebase-app-compat.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/9.19.1/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-functions-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-messaging-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-storage-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-analytics-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-remote-config-compat.js"></script>
    <script defer src="/__/firebase/9.19.1/firebase-performance-compat.js"></script>

    <script defer src="/__/firebase/init.js?useEmulator=true"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N"
        crossorigin="anonymous"></script>

    <style>
        body {
            font-size: 18px;
        }

        .bold {
            font-weight: bolder;
        }

        .code-box {
            background-color: #2b2b2b;
            /* Couleur de fond foncée */
            padding: 10px;
            border: 1px solid #ccc;
            font-family: monospace;
            color: #fff;
            /* Couleur du texte clair */
            height: 200px;
            overflow: auto;
            border-radius: 5px;
        }

        .code-header {
            border-radius: 5px;
            background-color: #333;
            /* Couleur de fond de la barre de titre */
            color: #fff;
            /* Couleur du texte de la barre de titre */
            padding: 3px;
            font-weight: bold;
        }

        a {
            color: black;
            text-decoration: none;
            /* Couleur par défaut des liens non visités */
        }

        a:visited {
            color: black;
            /* Couleur des liens visités */
            text-decoration: none;
            /* Enlève le soulignement des liens visités */
        }
    </style>

</head>

<body id="body1" data-bs-theme="light">

    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="./index.html">Pixelwatch-Sensor</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./ppg.html">Capteur PPG</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./galvanic.html">Capteur Galvanic</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="m-5">
        <hr>
    </div>


    <div class="">

        <div class="row">
            <div class="col-md-5 offset-md-1">
                <h2>Acquisition de donnée capteurs d’une Pixel Watch</h2>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-5 offset-md-2">
                <ul class="list-group">
                    <a href="./ppg.html#ppg">
                        <li class="list-group-item bold">Capteur PPG</li>
                    </a>
                    <a href="./ppg.html#fonctionnement">
                        <li class="list-group-item">&emsp;&emsp;&emsp;Fonctionnement</li>
                    </a>
                    <a href="./ppg.html#acquisition">
                        <li class="list-group-item">&emsp;&emsp;&emsp;Acquisition des données</li>
                    </a>
                    <a href="./ppg.html#analyse">
                        <li class="list-group-item">&emsp;&emsp;&emsp;Analyse des données</li>
                    </a>
                </ul>
            </div>
        </div>
        <br>
        <br>
        <div class="row">
            <div class="col-md-9 offset-md-1">
                <h4 id="ppg">Capteur PPG</h4>
                <br>
                <p>Un capteur de PPG (Photopléthysmographie), également connu sous le nom de Photoplethysmography en
                    anglais, est un dispositif utilisé pour mesurer les variations de volume sanguin. <br>
                    Le capteur de PPG peut être intégré dans différents appareils, tels que les montres connectées, les
                    bracelets d'activité ou les oxymètres de pouls. Il permet de surveiller en temps réel le rythme
                    cardiaque, l'activité physique et d'autres indicateurs de santé, offrant ainsi des fonctionnalités
                    de suivi et d'analyse pour les utilisateurs.<br>
                    Dans le cas de la Pixel Watch, ce capteur est équipé de deux canaux différents : un premier émettant
                    une lumière verte et un second émettant une lumière rouge, offrant ainsi une meilleure précision. De
                    plus, le capteur est accompagné d'un capteur de lumière ambiante positionné sur le côté en contact
                    avec la peau de la montre, ce qui permet de recueillir les données nécessaires pour le traitement
                    ultérieur.<br>
                </p>

                <h5 id="fonctionnement">Fonctionnement</h5>
                <br>
                <p>Lorsque la lumière émise par le capteur de PPG traverse la peau, elle est partiellement absorbée par
                    le sang circulant dans les vaisseaux sanguins situés à proximité. Le sang contient de l'hémoglobine,
                    qui absorbe la lumière à certaines longueurs d'onde spécifiques. Les variations de volume sanguin
                    causées par les battements cardiaques entraînent des changements dans l'absorption de la lumière par
                    l'hémoglobine.<br>
                    Le capteur de PPG mesure ces variations d'absorption de la lumière et les convertit en une série de
                    valeurs. En analysant ces valeurs au fil du temps, il est possible de reconstruire le profil
                    temporel du volume sanguin pulsatile, ce qui permet de calculer la fréquence cardiaque.<br>
                    En d'autres termes, le capteur de PPG détecte les changements de l'intensité lumineuse réfléchie ou
                    transmise à travers la peau, qui sont directement liés aux variations de volume sanguin causées par
                    les battements cardiaques. Ces variations sont ensuite interprétées et traduites en une fréquence
                    cardiaque mesurée.<br>
                    Il convient de noter que le capteur de PPG peut également fournir d'autres informations, telles que
                    des données sur la variabilité du rythme cardiaque, l'oxygénation du sang et l'évaluation de la
                    qualité du signal PPG. Cependant, la précision de ces mesures peut varier en fonction de la qualité
                    du capteur, des conditions environnementales et de l'activité physique de l'individu.<br>
                </p>

                <h5 id="acquisition">Acquisition des données</h5>
                <br>
                <p>
                    Pour récupérer les données d’un capteur sur Android, nous avons utilisé un SensorListener qui va
                    permettre d’écouter le capteur voulu à une fréquence définit. (voir repo associé)
                    Dans le cadre de la montre Google Pixel Watch nous avons pu récolter différentes données de ce
                    capteur. En effet a chaque itération le capteur nous renvoi un tableau de 7 entrées (+timestamp) ,
                    contenant les valeurs suivantes :<br></p>
                <ul>
                    <li>Nous avons tout d’abords le timestamp indiquant la date à laquelle les données ont été récoltés
                    </li>
                    <li>Dans la première colonne des données récupérés nous avons la valeur de lumière ambiante
                        indiquant la luminosité sur la face arrière de la montre</li>
                    <li>La deuxième colonne nous indique la variabilité du signal récupéré</li>
                    <li>La troisième colonne nous indique la puissance du signal émis sur le canal 1</li>
                    <li>La quatrième colonne nous indique la valeur récupérée par le canal 1</li>
                    <li>La cinquième colonne nous indique la valeur récupérée par le canal 2</li>
                    <li>La sixième colonne nous indique la puissance du signal émis par le canal 2</li>
                    <li>Enfin la septième colonne nous renvoi la valeur du signal traité en fonction des valeurs des
                        deux canaux et de la valeur de luminosité ambiante.</li>
                </ul>
                <p>Grace a ce capteur il est également possible de savoir si la montre est portée par l’utilisateur
                    puisque la lumière ambiante sera anormalement élevée si l’utilisateur ne porte pas la montre. De
                    plus le canal 2 ne sera alors plus actif et renverra toujours comme valeur par défaut 0.</p>
                <p> Ce capteur étant énergivore la fréquence maximale a laquelle il peut être exécuté ne peut pas
                    dépasser les 25Hz et ce même avec des autorisations spéciales alors que sur d’autres modèles tels
                    que la montre Fossil, le capteur de PPG peut être poussé jusqu’à 100Hz.</p>


                <h5 id="analyse">Analyse des données</h5>
                <br>
                <p>Selon le chipset utilisé (AFE4950 de chez Texas Instrument), une ou plusieurs valeurs peuvent être
                    renvoyé. Dans
                    le cadre de la Pixel Watch, c’est un tableau de 16 valeurs qui est renvoyé. Sur une montre de marque
                    différente
                    (eg. La fossil, uniquement la valeur traité).</p>

                <img class="mx-auto p-2" src="./ressources/Image1.png" />

                <p>Sur les 16 valeurs, on peut émettre différentes hypothèses quant à la signification des valeurs. En
                    effet, Google
                    étant très opaque sur ce sujet, au cours de nombreux test nous avons déduit que chaque colonne
                    pouvait faire
                    référence, au TimeStamp en millisecondes pour la première colonne, au délai d’acquisition pour la
                    seconde (temps
                    depuis la première acquisition), en seconde . On peut également trouver la valeur du capteur de
                    lumière ambiante
                    en 3ème position, qui est assez utile pour le traitement de signal. Les colonnes 6 et 7 devrait
                    correspondre au
                    signal de chaque canal, du fait de leur similarité.</p>

                <p>La valeur permettant d’indiquer le signal traité, du capteur de PPG est la dernière qui n’est pas
                    égale à 0.
                    Elle nous permet d’obtenir le graphique suivant :</p>


                <img class="mx-auto p-2" src="./ressources/Image2.png" />

                <p>On notera des variations du signal verticale en raison des mouvements de l’invidu portant la montre.
                </p>
                <br>
                <br>
                <br>
            </div>
        </div>
    </div>


    <ul class="nav navbar-expand-lg bg-body-tertiary justify-content-center fixed-bottom">
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="./">Home</a>
        </li>
    </ul>
</body>

</html>